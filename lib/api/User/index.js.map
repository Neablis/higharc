{"version":3,"sources":["../../../src/api/User/index.ts"],"names":["UserRouter","use","isLoggedIn","route","get","req","resp","email","context","user","User","findOne","relations","status","send","delete","results","createQueryBuilder","from","where","execute","console","log"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEA,MAAMA,UAAU,GAAG,sBAAnB;AAEAA,UAAU,CAACC,GAAX,CAAeC,iBAAf;AAEAF,UAAU,CAACG,KAAX,CAAiB,GAAjB,EACGC,GADH,CACO,OAAOC,GAAP,EAAYC,IAAZ,KAAoC;AACvC,QAAM;AAAEC,IAAAA;AAAF,MAAYF,GAAG,CAACG,OAAtB;AACA,QAAMC,IAAI,GAAG,MAAMC,cAAKC,OAAL,CAAa;AAAEJ,IAAAA;AAAF,GAAb,EAAwB;AAAEK,IAAAA,SAAS,EAAE,CAAC,WAAD,EAAc,uBAAd;AAAb,GAAxB,CAAnB;;AAEA,MAAI,CAACH,IAAL,EAAW;AACTH,IAAAA,IAAI,CAACO,MAAL,CAAY,GAAZ,EAAiBC,IAAjB,CAAsB,qBAAtB;AACD,GAFD,MAEO;AACLR,IAAAA,IAAI,CAACQ,IAAL,CAAUL,IAAV;AACD;AACF,CAVH,EAWGM,MAXH,CAWU,OAAOV,GAAP,EAAYC,IAAZ,KAAoC;AAC1C,QAAM;AAAEC,IAAAA;AAAF,MAAYF,GAAG,CAACG,OAAtB;AAEA,QAAMQ,OAAO,GAAG,MAAM,8BACnBC,kBADmB,GAEnBF,MAFmB,GAGnBG,IAHmB,CAGdR,aAHc,EAInBS,KAJmB,CAIb,gBAJa,EAIK;AAAEZ,IAAAA;AAAF,GAJL,EAKnBa,OALmB,EAAtB;AAOAC,EAAAA,OAAO,CAACC,GAAR,CAAY;AAAEN,IAAAA;AAAF,GAAZ;AAEAV,EAAAA,IAAI,CAACQ,IAAL,CAAU,IAAV;AACD,CAxBH;eA0Bed,U","sourcesContent":["import User from '../../entity/User';\nimport { Router } from 'express';\nimport { isLoggedIn } from '../../utils';\nimport { getConnection } from 'typeorm';\n\nconst UserRouter = Router();\n\nUserRouter.use(isLoggedIn)\n\nUserRouter.route('/')\n  .get(async (req, resp): Promise<void> => {\n    const { email } = req.context;\n    const user = await User.findOne({ email }, { relations: ['smoothies', 'smoothies.ingredients'] });\n\n    if (!user) {\n      resp.status(404).send('Could not find user');\n    } else {\n      resp.send(user);\n    }\n  })\n  .delete(async (req, resp): Promise<void> => {\n    const { email } = req.context;\n\n    const results = await getConnection()\n      .createQueryBuilder()\n      .delete()\n      .from(User)\n      .where(\"email = :email\", { email })\n      .execute();\n\n    console.log({ results });\n\n    resp.send(true)\n  })\n\nexport default UserRouter;"],"file":"index.js"}